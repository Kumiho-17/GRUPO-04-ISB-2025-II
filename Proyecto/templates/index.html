<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>EMG Hand Rehab ‚Äì Stroke Support</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    :root {
      --bg-main: #f3f7fb;
      --bg-card: #ffffff;
      --accent: #1abc9c;
      --accent-soft: rgba(26, 188, 156, 0.08);
      --accent-strong: #0e8f72;
      --text-dark: #1f2933;
      --text-muted: #6b7a8c;
      --border-soft: #e0e7f1;
      --danger: #e74c3c;
      --shadow-soft: 0 18px 40px rgba(15, 35, 52, 0.08);
      --radius-card: 18px;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: "Poppins", sans-serif;
      background: radial-gradient(circle at top left, #e6f8ff 0, #f6fbff 45%, #f3f7fb 100%);
      color: var(--text-dark);
      min-height: 100vh;
      display: flex;
    }

    /* Layout principal */
    .app-container {
      display: flex;
      width: 100%;
      max-width: 1366px;
      margin: 0 auto;
      padding: 24px;
      gap: 24px;
    }

    /* Sidebar */
    .sidebar {
      width: 230px;
      background: rgba(255, 255, 255, 0.95);
      border-radius: 24px;
      box-shadow: var(--shadow-soft);
      padding: 20px 18px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      backdrop-filter: blur(12px);
    }

    .logo-area {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 18px;
    }

    .logo-icon {
      width: 40px;
      height: 40px;
      border-radius: 14px;
      background: linear-gradient(145deg, #1abc9c, #16a085);
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
      font-weight: 700;
      font-size: 18px;
      box-shadow: 0 12px 24px rgba(26, 188, 156, 0.4);
    }

    .logo-text {
      display: flex;
      flex-direction: column;
      line-height: 1.2;
    }

    .logo-text span:first-child {
      font-size: 14px;
      font-weight: 600;
      letter-spacing: 0.04em;
      color: var(--accent-strong);
    }

    .logo-text span:last-child {
      font-size: 11px;
      color: var(--text-muted);
    }

    .sidebar-title {
      margin-top: 8px;
      margin-bottom: 18px;
      font-size: 13px;
      font-weight: 600;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.08em;
    }

    .nav-list {
      list-style: none;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .nav-item {
      padding: 8px 10px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      gap: 10px;
      cursor: pointer;
      font-size: 13px;
      color: var(--text-muted);
      transition: background 0.2s ease, color 0.2s ease, transform 0.1s ease;
    }

    .nav-item span.icon {
      width: 22px;
      height: 22px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #f2f6fb;
      font-size: 12px;
    }

    .nav-item.active {
      background: var(--accent-soft);
      color: var(--accent-strong);
      transform: translateX(4px);
    }

    .nav-footer {
      margin-top: 20px;
      padding: 12px 10px;
      border-radius: 16px;
      background: #f3faf8;
      font-size: 11px;
      color: var(--text-muted);
      line-height: 1.4;
    }

    .nav-footer strong {
      color: var(--accent-strong);
    }

    /* Contenido principal */
    .main-content {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 18px;
    }

    .top-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .title-block h1 {
      font-size: 24px;
      font-weight: 600;
      letter-spacing: 0.02em;
      margin-bottom: 4px;
    }

    .title-block p {
      font-size: 13px;
      color: var(--text-muted);
    }

    .badge-pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 10px;
      border-radius: 999px;
      background: var(--accent-soft);
      color: var(--accent-strong);
      font-size: 11px;
      font-weight: 500;
    }

    .badge-pill span.icon {
      width: 18px;
      height: 18px;
      border-radius: 999px;
      background: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 11px;
    }

    .content-grid {
      display: grid;
      grid-template-columns: 2.2fr 1.5fr;
      gap: 18px;
    }

    .card {
      background: var(--bg-card);
      border-radius: var(--radius-card);
      box-shadow: var(--shadow-soft);
      padding: 18px 20px;
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 14px;
    }

    .card-header h2 {
      font-size: 16px;
      font-weight: 600;
    }

    .card-header small {
      font-size: 11px;
      color: var(--text-muted);
    }

    .section-label {
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: var(--accent-strong);
      margin-bottom: 6px;
    }

    .form-group {
      margin-bottom: 12px;
    }

    .form-group label {
      font-size: 13px;
      font-weight: 500;
      display: block;
      margin-bottom: 4px;
    }

    .file-input {
      width: 100%;
      padding: 10px;
      border-radius: 10px;
      border: 1px dashed var(--border-soft);
      font-size: 13px;
      background: #f7f9fc;
    }

    .file-input::-webkit-file-upload-button {
      border: none;
      background: var(--accent);
      color: #fff;
      padding: 8px 12px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 12px;
      font-weight: 500;
      margin-right: 10px;
    }

    .model-options {
      display: flex;
      flex-direction: column;
      gap: 4px;
      margin-top: 6px;
      font-size: 13px;
    }

    .model-options label {
      display: flex;
      align-items: center;
      gap: 6px;
      cursor: pointer;
      color: var(--text-muted);
    }

    .model-options input[type="radio"] {
      accent-color: var(--accent-strong);
    }

    .small-hint {
      font-size: 11px;
      color: var(--text-muted);
      margin-top: 4px;
    }

    .gesture-select {
      width: 100%;
      padding: 8px 10px;
      border-radius: 10px;
      border: 1px solid var(--border-soft);
      font-size: 13px;
      background: #f9fbff;
    }

    .btn-primary {
      margin-top: 10px;
      padding: 9px 18px;
      border-radius: 999px;
      border: none;
      background: linear-gradient(135deg, #1abc9c, #16a085);
      color: #fff;
      font-weight: 600;
      font-size: 14px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      box-shadow: 0 12px 22px rgba(26, 188, 156, 0.45);
      transition: transform 0.12s ease, box-shadow 0.12s ease;
    }

    .btn-primary span.icon {
      background: rgba(255, 255, 255, 0.18);
      width: 22px;
      height: 22px;
      border-radius: 999px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 13px;
    }

    .btn-primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 16px 30px rgba(26, 188, 156, 0.55);
    }

    /* Resultado / biofeedback */
    .result-grid {
      display: grid;
      grid-template-columns: 2.2fr 1.8fr;
      gap: 18px;
    }

    .result-title {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 10px;
    }

    .result-row {
      margin-bottom: 6px;
      font-size: 13px;
    }

    .result-row span.label {
      font-weight: 500;
      color: var(--text-muted);
    }

    .confidence-bar-wrapper {
      margin-top: 8px;
      margin-bottom: 8px;
    }

    .confidence-bar-bg {
      width: 100%;
      height: 10px;
      background: #edf1f7;
      border-radius: 999px;
      overflow: hidden;
    }

    .confidence-bar-fill {
      height: 100%;
      border-radius: 999px;
      transition: width 0.25s ease;
    }

    .fill-high {
      background: linear-gradient(90deg, #1abc9c, #2ecc71);
    }

    .fill-medium {
      background: linear-gradient(90deg, #f1c40f, #f39c12);
    }

    .fill-low {
      background: linear-gradient(90deg, #e74c3c, #c0392b);
    }

    .confidence-text {
      margin-top: 4px;
      font-size: 12px;
      color: var(--text-muted);
      display: flex;
      justify-content: space-between;
    }

    .badge-confidence {
      padding: 2px 10px;
      border-radius: 999px;
      font-size: 11px;
      font-weight: 500;
    }

    .badge-high {
      background: rgba(39, 174, 96, 0.1);
      color: #27ae60;
    }

    .badge-medium {
      background: rgba(241, 196, 15, 0.15);
      color: #d99a00;
    }

    .badge-low {
      background: rgba(231, 76, 60, 0.1);
      color: #e74c3c;
    }

    .feedback-box {
      margin-top: 8px;
      padding: 8px 10px;
      border-radius: 10px;
      font-size: 12px;
      line-height: 1.4;
    }

    .feedback-success {
      background: #ecfdf5;
      color: #15803d;
    }

    .feedback-fail {
      background: #fef2f2;
      color: #b91c1c;
    }

    .prob-list {
      margin-top: 10px;
      font-size: 13px;
      list-style: none;
    }

    .prob-list li {
      margin-bottom: 4px;
      display: flex;
      justify-content: space-between;
      gap: 6px;
    }

    .prob-label {
      color: var(--text-muted);
    }

    .tag-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 12px;
    }

    .tag-pill {
      padding: 4px 10px;
      border-radius: 999px;
      font-size: 11px;
      background: #f1f5f9;
      color: var(--text-muted);
    }

    .tag-pill.primary {
      background: var(--accent-soft);
      color: var(--accent-strong);
    }

    .footer-note {
      margin-top: 8px;
      font-size: 10px;
      color: var(--text-muted);
      text-align: center;
    }

    /* Gesto visual */
    .gesture-visual {
      display: flex;
      align-items: center;
      gap: 12px;
      margin: 10px 0 6px 0;
    }

    .gesture-icon {
      width: 56px;
      height: 56px;
      border-radius: 18px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 30px;
      box-shadow: 0 10px 20px rgba(15, 35, 52, 0.18);
    }

    .gv-high {
      background: #ecfdf5;
    }

    .gv-medium {
      background: #fffbeb;
    }

    .gv-low {
      background: #fef2f2;
    }

    .gesture-quality-text {
      font-size: 12px;
      color: var(--text-muted);
      max-width: 280px;
    }

    /* Tabla historial */
    table {
      border-collapse: collapse;
    }

    th, td {
      padding: 6px 4px;
      font-size: 12px;
    }

    th {
      text-align: left;
      border-bottom: 1px solid #e5e7eb;
      color: var(--text-muted);
      font-weight: 500;
    }

    tr + tr td {
      border-top: 1px solid #f1f5f9;
    }

    /* Responsivo simple */
    @media (max-width: 1024px) {
      .app-container {
        flex-direction: column;
      }

      .sidebar {
        flex-direction: row;
        align-items: center;
        width: 100%;
      }

      .content-grid,
      .result-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
<div class="app-container">
  <!-- Sidebar -->
  <aside class="sidebar">
    <div>
      <div class="logo-area">
        <div class="logo-icon">EMG</div>
        <div class="logo-text">
          <span>Hand Rehab</span>
          <span>Stroke Support ¬∑ Proto</span>
        </div>
      </div>

      <div class="sidebar-title">Panel</div>
      <ul class="nav-list">
        <li class="nav-item active" data-section="top">
          <span class="icon">üè†</span> Dashboard
        </li>
        <li class="nav-item" data-section="classify">
          <span class="icon">ü§ñ</span> Clasificaci√≥n
        </li>
        <li class="nav-item" data-section="result">
          <span class="icon">üéØ</span> Entrenamiento guiado
        </li>
        <li class="nav-item" data-section="emg">
          <span class="icon">üìà</span> Se√±al EMG
        </li>
        <li class="nav-item" data-section="history">
          <span class="icon">üìÅ</span> Historial
        </li>
        <li class="nav-item" data-section="about">
          <span class="icon">‚ÑπÔ∏è</span> Acerca del prototipo
        </li>
      </ul>
    </div>

    <div class="nav-footer">
      <strong>Nota:</strong> Prototipo acad√©mico para explorar IA + sEMG
      en rehabilitaci√≥n del miembro superior post-ACV. No es un dispositivo m√©dico real.
    </div>
  </aside>

  <!-- Contenido principal -->
  <main class="main-content">
    <header class="top-header" id="top-section">
      <div class="title-block">
        <h1>EMG Hand Rehab ‚Äì Stroke Support</h1>
        <p>Reconocimiento de gestos de mano con EMG como apoyo a la rehabilitaci√≥n post-ACV.</p>
      </div>
      <div class="badge-pill">
        <span class="icon">üß†</span>
        IA ¬∑ EMG ¬∑ Telerehab
      </div>
    </header>

    <!-- Grid principal: clasificaci√≥n + resumen sesi√≥n -->
    <div class="content-grid">
      <!-- Card: clasificaci√≥n -->
      <section class="card" id="classify-section">
        <div class="card-header">
          <div>
            <div class="section-label">1 ¬∑ Clasificaci√≥n</div>
            <h2>Cargar se√±al EMG y seleccionar modelo</h2>
          </div>
          <small>Datos simulados para demo.</small>
        </div>

        <form method="POST" enctype="multipart/form-data">
          <div class="form-group">
            <label for="emg_file">Archivo de se√±al EMG (.mat / .npy)</label>
            <input
              type="file"
              id="emg_file"
              name="emg_file"
              class="file-input"
              accept=".mat,.npy"
            />
            <div class="small-hint">
              Por ahora el sistema utiliza <strong>se√±ales EMG simuladas</strong>.
              No es necesario seleccionar un archivo real.
            </div>
          </div>

          <div class="form-group">
            <label>Modelo de clasificaci√≥n</label>
            <div class="model-options">
              <label>
                <input type="radio" name="model" value="mlp"
                  {% if not result or result.model_name == 'mlp' %}checked{% endif %}>
                <strong>MLP</strong> ‚Äì Features EMG (110 caracter√≠sticas)
              </label>
              <label>
                <input type="radio" name="model" value="cnn_base"
                  {% if result and result.model_name == 'cnn_base' %}checked{% endif %}>
                <strong>CNN base</strong> ‚Äì Ventanas crudas (400√ó10)
              </label>
              <label>
                <input type="radio" name="model" value="cnn_mejorada"
                  {% if result and result.model_name == 'cnn_mejorada' %}checked{% endif %}>
                <strong>CNN mejorada</strong> ‚Äì Ventanas crudas (400√ó10, latente 64-D)
              </label>
            </div>
          </div>

          <div class="form-group">
            <label for="target_gesture">Gesto objetivo (modo entrenamiento guiado)</label>
            <select id="target_gesture" name="target_gesture" class="gesture-select">
              <option value="">Sin gesto objetivo (solo clasificar)</option>
              {% for idx, name in gesture_labels.items() %}
                <option value="{{ idx }}"
                  {% if target_gesture is not none and target_gesture == idx %}selected{% endif %}>
                  Clase {{ idx }} ‚Äì {{ name }}
                </option>
              {% endfor %}
            </select>
            <div class="small-hint">
              Si eliges un gesto, el sistema te dir√° si la clasificaci√≥n coincide con el objetivo.
            </div>
          </div>

          <button type="submit" class="btn-primary">
            <span class="icon">‚ö°</span>
            Clasificar gesto
          </button>
        </form>
      </section>

      <!-- Card: resumen breve sesi√≥n -->
      <section class="card">
        <div class="card-header">
          <div>
            <div class="section-label">Vista r√°pida</div>
            <h2>Resumen de la sesi√≥n</h2>
          </div>
        </div>
        <p style="font-size:13px; color:var(--text-muted); line-height:1.55;">
          Usa esta pantalla como un peque√±o dashboard cl√≠nico para explorar c√≥mo
          un sistema de IA podr√≠a apoyar la rehabilitaci√≥n de mano post-ACV.
        </p>
        <div class="tag-row">
          <div class="tag-pill primary">4 gestos funcionales</div>
          <div class="tag-pill">Datos simulados</div>
          <div class="tag-pill">Biofeedback</div>
          <div class="tag-pill">Historial por sesi√≥n</div>
        </div>
      </section>
    </div>

    <!-- Resultados -->
    <section class="card" id="result-section">
      <div class="card-header">
        <div>
          <div class="section-label">2 ¬∑ Resultado</div>
          <h2>Resultado de la clasificaci√≥n y biofeedback</h2>
        </div>
      </div>

      {% if result %}
        <div class="result-grid">
          <!-- Columna izquierda: gesto y confianza -->
          <div>
            <div class="result-title">Gesto detectado</div>

            <div class="result-row">
              <span class="label">Modelo usado:</span>
              {{ result.model_display }}
            </div>

            <div class="result-row">
              <span class="label">Gesto real simulado:</span>
              Clase {{ result.true_gesture_idx }} ‚Äì {{ result.true_gesture_name }}
            </div>

            <div class="result-row">
              <span class="label">Gesto detectado:</span>
              Clase {{ result.gesture_idx }} ‚Äì
              <strong>{{ result.gesture_name }}</strong>
            </div>

            <div class="gesture-visual">
              <div class="gesture-icon
                {% if result.confidence_level == 'high' %}gv-high{% elif result.confidence_level == 'medium' %}gv-medium{% else %}gv-low{% endif %}">
                {% if result.gesture_idx == 0 %}üçæ
                {% elif result.gesture_idx == 1 %}ü§è
                {% elif result.gesture_idx == 2 %}‚úã
                {% else %}‚úä{% endif %}
              </div>
              <div class="gesture-quality-text">
                {% if result.confidence_level == 'high' %}
                  Calidad del gesto: <strong>√≥ptima</strong>. Patr√≥n EMG muy definido.
                {% elif result.confidence_level == 'medium' %}
                  Calidad del gesto: <strong>intermedia</strong>. Ajusta la postura y repite.
                {% else %}
                  Calidad del gesto: <strong>baja</strong>. Posible ruido o co-activaci√≥n.
                {% endif %}
              </div>
            </div>

            <div class="confidence-bar-wrapper">
              <div class="confidence-bar-bg">
                <div class="confidence-bar-fill
                  {% if result.confidence_level == 'high' %}fill-high{% elif result.confidence_level == 'medium' %}fill-medium{% else %}fill-low{% endif %}"
                  style="width: {{ result.confidence_pct }}%;"></div>
              </div>
              <div class="confidence-text">
                <span>Confianza del modelo</span>
                <span>
                  {{ result.confidence_pct }}%
                  {% if result.confidence_level == 'high' %}
                    <span class="badge-confidence badge-high">Alta</span>
                  {% elif result.confidence_level == 'medium' %}
                    <span class="badge-confidence badge-medium">Media</span>
                  {% else %}
                    <span class="badge-confidence badge-low">Baja</span>
                  {% endif %}
                </span>
              </div>
            </div>

            {% if result.match_target is not none %}
              <div class="feedback-box {% if result.match_target %}feedback-success{% else %}feedback-fail{% endif %}">
                {{ result.feedback_text }}
                {% if result.match_target %}
                  Sugerencia: mant√©n el gesto unos segundos y repite varias veces
                  para reforzar el patr√≥n motor.
                {% else %}
                  Tip: revisa la posici√≥n de los dedos y el antebrazo e intenta
                  reproducir de nuevo el gesto objetivo.
                {% endif %}
              </div>
            {% else %}
              <div class="small-hint" style="margin-top:8px;">
                Selecciona un <strong>gesto objetivo</strong> en la secci√≥n 1 para usar este m√≥dulo
                como sistema de entrenamiento.
              </div>
            {% endif %}

            {% if result.train_attempts > 0 %}
              <div class="small-hint" style="margin-top:8px;">
                Sesi√≥n de entrenamiento: <strong>{{ result.train_attempts }}</strong> intentos,
                <strong>{{ result.train_success }}</strong> aciertos
                ({{ (100 * result.train_success / result.train_attempts) | round(1) }}%).
              </div>
            {% endif %}
          </div>

          <!-- Columna derecha: probabilidades por clase -->
          <div>
            <div class="result-title">Probabilidades por gesto</div>
            <ul class="prob-list">
              {% for g in result.probs %}
                <li>
                  <span class="prob-label">Clase {{ g.idx }} ‚Äì {{ g.name }}</span>
                  <span>{{ g.prob }} %</span>
                </li>
              {% endfor %}
            </ul>
            <div class="small-hint" style="margin-top:10px;">
              Estas probabilidades corresponden a una ventana EMG simulada.
            </div>
          </div>
        </div>
      {% else %}
        <p style="font-size:13px; color:var(--text-muted);">
          A√∫n no has clasificado ninguna se√±al. Pulsa
          <strong>‚ÄúClasificar gesto‚Äù</strong> para ver el resultado del modelo,
          la confianza y el biofeedback.
        </p>
      {% endif %}
    </section>

    <!-- Se√±al EMG -->
    <section class="card" id="emg-section">
      <div class="card-header">
        <div>
          <div class="section-label">3 ¬∑ Se√±al EMG</div>
          <h2>Visualizaci√≥n de EMG cruda y envolvente RMS</h2>
        </div>
      </div>

      {% if emg_plot %}
        <p style="font-size:13px; color:var(--text-muted); margin-bottom:10px;">
          Se muestra la se√±al EMG simulada (canal √∫nico) y una envolvente RMS
          calculada sobre ventanitas consecutivas.
        </p>
        <div style="width:100%; height:260px;">
          <canvas id="emgChart"></canvas>
        </div>
      {% else %}
        <p style="font-size:13px; color:var(--text-muted);">
          Clasifica un gesto para generar una se√±al EMG simulada y visualizarla aqu√≠.
        </p>
      {% endif %}
    </section>

    <!-- Historial -->
    <section class="card" id="history-section">
      <div class="card-header">
        <div>
          <div class="section-label">4 ¬∑ Historial</div>
          <h2>Historial reciente de clasificaciones</h2>
        </div>
      </div>

      {% if history and history|length > 0 %}
        <div style="overflow-x:auto;">
          <table style="width:100%;">
            <thead>
            <tr>
              <th>Fecha y hora</th>
              <th>Modelo</th>
              <th>Gesto detectado</th>
              <th>Conf.</th>
              <th>Objetivo</th>
              <th>Resultado</th>
            </tr>
            </thead>
            <tbody>
            {% for h in history|reverse %}
              <tr>
                <td>{{ h.timestamp }}</td>
                <td>{{ h.model_display }}</td>
                <td>Clase {{ h.gesture_idx }} ‚Äì {{ h.gesture_name }}</td>
                <td>{{ h.confidence_pct }}%</td>
                <td>
                  {% if h.target_gesture is not none %}
                    Clase {{ h.target_gesture }}
                  {% else %}
                    ‚Äì
                  {% endif %}
                </td>
                <td>
                  {% if h.match_target is none %}
                    Solo clasificaci√≥n
                  {% elif h.match_target %}
                    ‚úÖ Acierto
                  {% else %}
                    ‚ùå Fallo
                  {% endif %}
                </td>
              </tr>
            {% endfor %}
            </tbody>
          </table>
        </div>
      {% else %}
        <p style="font-size:13px; color:var(--text-muted);">
          A√∫n no hay clasificaciones registradas en esta sesi√≥n.
        </p>
      {% endif %}
    </section>

    <!-- Acerca del prototipo -->
    <section class="card" id="about-section">
      <div class="card-header">
        <div>
          <div class="section-label">5 ¬∑ Acerca del prototipo</div>
          <h2>Contexto cl√≠nico y t√©cnico</h2>
        </div>
      </div>
      <p style="font-size:13px; color:var(--text-muted); line-height:1.55;">
        Este prototipo explora el uso de <strong>electromiograf√≠a de superficie (sEMG)</strong> y
        <strong>modelos de IA</strong> para reconocer cuatro gestos funcionales de mano
        (open bottle, lateral grasp, parallel extension grasp y power grasp) en el contexto de
        <strong>rehabilitaci√≥n del miembro superior post-ACV</strong>.
      </p>
      <p style="font-size:13px; color:var(--text-muted); line-height:1.55; margin-top:8px;">
        En una implementaci√≥n futura, las se√±ales EMG reales podr√≠an provenir de armbands o
        electrodos sEMG y ser procesadas por modelos MLP/CNN entrenados con bases de datos
        como <strong>NinaPro DB1</strong>, integr√°ndose a plataformas de
        <strong>telerehabilitaci√≥n</strong> con biofeedback objetivo.
      </p>

      <div class="tag-row">
        <div class="tag-pill primary">sEMG</div>
        <div class="tag-pill">Rehabilitaci√≥n post-ACV</div>
        <div class="tag-pill">MLP</div>
        <div class="tag-pill">CNN</div>
        <div class="tag-pill">NinaPro DB1</div>
        <div class="tag-pill">Biofeedback</div>
      </div>
    </section>

    <div class="footer-note">
      Prototipo acad√©mico ¬∑ Ingenier√≠a Biom√©dica ¬∑ IA + sEMG para apoyo a la rehabilitaci√≥n post-ACV.
    </div>
  </main>
</div>

<script>
  // navegaci√≥n del sidebar (scroll suave a las secciones)
  document.querySelectorAll('.nav-item').forEach(item => {
    item.addEventListener('click', () => {
      const target = item.getAttribute('data-section');
      const section = document.getElementById(target + '-section');
      if (section) {
        section.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
      document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
      item.classList.add('active');
    });
  });
</script>

{% if emg_plot %}
<script>
  const emgRaw = {{ emg_plot.raw | tojson }};
  const emgRms = {{ emg_plot.rms | tojson }};
  const emgLabels = emgRaw.map((_, i) => i);

  const ctxEmg = document.getElementById('emgChart').getContext('2d');
  new Chart(ctxEmg, {
    type: 'line',
    data: {
      labels: emgLabels,
      datasets: [
        {
          label: 'EMG cruda',
          data: emgRaw,
          borderWidth: 1,
          pointRadius: 0
        },
        {
          label: 'Envolvente RMS',
          data: emgRms,
          borderWidth: 1,
          pointRadius: 0
        }
      ]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: { labels: { font: { size: 11 } } }
      },
      scales: {
        x: { ticks: { display: false } },
        y: { ticks: { font: { size: 10 } } }
      }
    }
  });
</script>
{% endif %}
</body>
</html>